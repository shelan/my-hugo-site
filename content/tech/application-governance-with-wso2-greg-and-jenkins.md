+++
title = "Application Governance with WSO2 GReg and Jenkins"
date = 2013-02-03T18:05:00Z
updated = 2013-04-27T20:17:25Z
tags = ["wso2", "governance", "greg", "registry.jenkins"]
blogimport = true 
categories=["tech"]
[author]
	name = "Shelan Perera"
	uri = "https://plus.google.com/110975611609309023449"
+++

<div dir="ltr" style="text-align: left;" trbidi="on"><div dir="ltr" style="text-align: left;" trbidi="on"><span style="font-family: Arial, Helvetica, sans-serif;">This tutorial will show how you can automate the application Governance using WSO2 Governance Registry and Jenkins (for Build Automation).</span><br /><b><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></b><b><span style="font-family: Arial, Helvetica, sans-serif;">Pre-Requisites&nbsp;</span></b><br /><br /><ul style="text-align: left;"><li><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal; text-align: -webkit-auto;"><span style="font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><a href="http://wso2.org/more-downloads/governance-registry" target="_blank"><span style="font-family: Arial, Helvetica, sans-serif;">WSO2 Governance Registry 4.5.1</span></a></span></b></li><li><b style="font-weight: normal; text-align: -webkit-auto;"><a href="http://jenkins-ci.org/" target="_blank"><span style="font-family: Arial, Helvetica, sans-serif;">Jenkins</span></a></b></li><li><b style="font-weight: normal; text-align: -webkit-auto;"><span style="font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><span style="font-family: Arial, Helvetica, sans-serif;">A svn location to store build artifacts.</span></span></b></li></ul><br /><h3 style="text-align: left;">Things to note</h3><div><ul style="text-align: left;"><li>Jenkins or similar build automation tool should be used to build the artifact and deploy it to the specific Dev SVN location.&nbsp;</li><li>There are three SVN locations required for Dev , QA and Production artifact deployment.&nbsp;</li><li>User needs to specify the exact name of the artifact (without the extension) as Application Name when adding the application to WSO2 Governance Registry.&nbsp;</li><li>This particular sample is tested with WSO2 Governance Registry 4.5.1. Therefore it is recommended to use the same version of the product.</li></ul><div><div class="separator" style="clear: both; font-weight: normal; text-align: center;"><b id="internal-source-marker_0.09183679078705609"><b id="internal-source-marker_0.4754765050020069"><b id="internal-source-marker_0.35913173598237336" style="font-weight: normal; text-align: -webkit-auto;"></b></b></b></div><b id="internal-source-marker_0.09183679078705609"><b id="internal-source-marker_0.4754765050020069"></b></b><br /><h3 style="text-align: left;">Resource Location</h3><h3 style="text-align: left;"><b id="internal-source-marker_0.09183679078705609"><b id="internal-source-marker_0.4754765050020069"><b id="internal-source-marker_0.35913173598237336" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">Please download resources from following location.</span><br /><span style="color: #1155cc; font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><a href="https://svn.wso2.org/repos/wso2/scratch/application-governance/">https://svn.wso2.org/repos/wso2/scratch/application-governance/</a></span></b></b></b></h3></div><h3 style="text-align: left;">Workflow</h3></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-u68BL7aFt1M/UQ8MFDLh4HI/AAAAAAAAA9U/bjIrWCXBs4I/s1600/Yenlog-Application-Governance.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="480" src="http://2.bp.blogspot.com/-u68BL7aFt1M/UQ8MFDLh4HI/AAAAAAAAA9U/bjIrWCXBs4I/s640/Yenlog-Application-Governance.png" width="640" /></a></div><div><br /></div><div><br /></div><div><br /></div><div><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><span style="font-family: Arial; font-size: 24px; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">Configurations</span></b></div><div><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 24px; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">n this workflow build automation is excluded and user needs to add the built artifact and first deploy to Dev SVN location. (Developer may use Jenkins to build and its plugin to add it to a SVN location)</span><br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span><br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">1) Create the Registry Extension file for Applications as specified below. Deploy the Application RXT file to Governance Registry as described in </span><a href="http://docs.wso2.org/wiki/display/Governance450/Deploying+an+Extension+File"><span style="color: #1155cc; font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">http://docs.wso2.org/wiki/display/Governance450/Deploying+an+Extension+File</span></a><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span><br /><span style="font-family: Arial; font-size: 13px; vertical-align: baseline; white-space: pre-wrap;"></span></b><br /><br /><pre><code>&lt;artifactType type="application/vnd.wso2-application+xml"<br /><br />shortName="applications" singularLabel="Application" pluralLabel="Applications" hasNamespace="false" iconSet="9"&gt;<br />&nbsp; &nbsp; &lt;storagePath&gt;/applications/@{overview_name}&lt;/storagePath&gt;<br />&nbsp;&lt;nameAttribute&gt;overview_name&lt;/nameAttribute&gt;<br />&nbsp; &nbsp; &lt;ui&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;list&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;column name="Name"&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;data type="path" value="overview_name" href="/applications/@{name}"/&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/column&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;column name="type"&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;data type="type" value="overview_type"/&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/column&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;/list&gt;<br />&nbsp; &nbsp; &lt;/ui&gt;<br />&nbsp; &nbsp; &lt;content&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;table name="Overview"&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;field type="text" required="true"&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;Name&lt;/name&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/field&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;field type="options"&gt;<br />&nbsp; &nbsp; &nbsp;&lt;name&gt;Type&lt;/name&gt;<br />&nbsp; &nbsp; &nbsp;&lt;values&gt;<br />&nbsp; &nbsp; &nbsp; &lt;value&gt;car&lt;/value&gt;<br />&nbsp; &nbsp; &nbsp; &lt;value&gt;war&lt;/value&gt;<br />&nbsp; &nbsp; &nbsp;&lt;/values&gt;<br />&nbsp; &nbsp; &lt;/field&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;field type="text-area"&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;name&gt;Description&lt;/name&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &lt;/field&gt;<br />&nbsp; &nbsp; &nbsp; &nbsp; &lt;/table&gt;<br />&nbsp; &nbsp; &lt;/content&gt;<br />&lt;/artifactType&gt;<br /><br /></code></pre></div></div><div style="font-weight: bold;"><br /></div><br /><b style="font-weight: normal;"><br /></b><br /><div><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">2) Create an Application in Governance Registry.</span><br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span><br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">Add→ Application</span></b></div><div><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><img height="346px;" src="https://lh3.googleusercontent.com/RU-9va3JeTxFIQI0qEc9EHHQevnpQF8ccatXBa7Noi-Ye6nHIRAvoL8fcy39BU6d_MrRo5nVx6wd7bh79cPdYssjbP223z-udpqRzR8SnwClFa2GnZ0" width="408px;" /></b></div><div><b style="font-weight: normal;"><br /></b></div><div><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">Specify </span><span style="font-family: Arial; font-size: 15px; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">Name</span><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"> of the car/war file. (This should be the exact name in the svn location without extension)</span><br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">eg: myCapp</span></b></div><div><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><img height="288px;" src="https://lh4.googleusercontent.com/uLSLDAtW9uT6Ty1Q_y_6Z3lhuXZYdacFLYolhEv_n6hTh-8kM9bMgZzK48SN22iuzKqiLpQeV1h8rTagmWbZI8XADHOTAt48O5AhG5AwmA379zwV7u0" width="569px;" /></b></div><div><b style="font-weight: normal;"><br /></b></div><div><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">3) Add Svn Executor to Governance Registry Server.</span><br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b><br /><ul style="margin-bottom: 0pt; margin-top: 0pt;"><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><li dir="ltr" style="font-family: Arial; font-size: 15px; list-style-type: disc; vertical-align: baseline;"><span style="vertical-align: baseline; white-space: pre-wrap;">Edit the </span><span style="font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">svn-executor-1.0.jar</span><span style="vertical-align: baseline; white-space: pre-wrap;">’s </span><span style="background-color: yellow; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">svn.properties</span><span style="vertical-align: baseline; white-space: pre-wrap;"> file and add your svn credentials and Jenkins URL.</span></li></b></ul><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b><br /><ul style="margin-bottom: 0pt; margin-top: 0pt;"><b id="internal-source-marker_0.09183679078705609" style="font-weight: normal;"><li dir="ltr" style="font-family: Arial; font-size: 15px; list-style-type: disc; vertical-align: baseline;"><span style="vertical-align: baseline; white-space: pre-wrap;">Copy the </span><span style="font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">svn-executor-1.0.jar</span><span style="vertical-align: baseline; white-space: pre-wrap;"> and </span><span style="font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">svnkit-bundle-1.0.0.jar </span><span style="vertical-align: baseline; white-space: pre-wrap;">(provided separately) to </span><span style="font-style: italic; vertical-align: baseline; white-space: pre-wrap;">G-REG_HOME/repository/components/lib </span><span style="vertical-align: baseline; white-space: pre-wrap;">folder.</span></li></b></ul><span id="internal-source-marker_0.09183679078705609"><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b></span><br /><ul style="margin-bottom: 0pt; margin-top: 0pt;"><span id="internal-source-marker_0.09183679078705609"><li dir="ltr" style="font-family: Arial; font-size: 15px; list-style-type: disc; vertical-align: baseline;"><span style="vertical-align: baseline; white-space: pre-wrap;">Copy<b> </b></span><span style="font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">svn-client-adapter-1.6.18.wso2v2.jar</span><span style="font-weight: bold; vertical-align: baseline; white-space: pre-wrap;"> </span><span style="vertical-align: baseline; white-space: pre-wrap;">to</span><span style="font-weight: bold; vertical-align: baseline; white-space: pre-wrap;"> </span><span style="font-style: italic; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">G-REG_HOME/repository/components/dropins </span><span style="font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">folder.</span></li></span></ul><span id="internal-source-marker_0.09183679078705609"></span><br /><div style="font-weight: bold;"><span id="internal-source-marker_0.09183679078705609"><span style="font-family: Arial;"><span style="font-size: 15px; white-space: pre-wrap;"><br /></span></span></span></div><span id="internal-source-marker_0.09183679078705609"></span><br /><div><div><span id="internal-source-marker_0.09183679078705609"><span id="internal-source-marker_0.09183679078705609"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">4) Add a new lifecycle in Governance Registry names </span><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">AppLifeCycle </span><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">by following the instructions provided in</span><br /><a href="http://docs.wso2.org/wiki/display/Governance450/Adding+Lifecycles"><span style="color: #1155cc; font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">http://docs.wso2.org/wiki/display/Governance450/Adding+Lifecycles</span></a><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">. Use the lifecycle configuration specified below.</span><br /></span></span><br /><pre><code> &lt;!--<br /> ~ Copyright (c) 2005-2010, WSO2 Inc. (http://www.wso2.org) All Rights Reserved.<br /> ~<br /> ~ WSO2 Inc. licenses this file to you under the Apache License,<br /> ~ Version 2.0 (the "License"); you may not use this file except<br /> ~ in compliance with the License.<br /> ~ You may obtain a copy of the License at<br /> ~<br /> ~    http://www.apache.org/licenses/LICENSE-2.0<br /> ~<br /> ~ Unless required by applicable law or agreed to in writing,<br /> ~ software distributed under the License is distributed on an<br /> ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY<br /> ~ KIND, either express or implied.  See the License for the<br /> ~ specific language governing permissions and limitations<br /> ~ under the License.<br /> --&gt;<br />&lt;aspect name="AppLifeCycle" class="org.wso2.carbon.governance.registry.extensions.aspects.DefaultLifeCycle"&gt;<br />    &lt;configuration type="literal"&gt;<br />        &lt;lifecycle&gt;<br />            &lt;scxml xmlns="http://www.w3.org/2005/07/scxml"<br />                   version="1.0"<br />                   initialstate="Development"&gt;<br />                &lt;state id="Development"&gt;<br />                    &lt;datamodel&gt;<br />                        &lt;data name="checkItems"&gt;<br />                            &lt;item name="Code Completed" forEvent=""&gt;                            <br />                            &lt;/item&gt;<br />                          <br />                            &lt;item name="Added to SVN" forEvent=""&gt;<br />                            &lt;/item&gt;<br />                        &lt;/data&gt;<br /><br />   &lt;data name="transitionExecution"&gt;<br />                            &lt;execution forEvent="Promote" class="org.wso2.carbon.executor.SvnDeploymentExecutor"&gt;<br />     &lt;parameter name="currentEnvironment" value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/dev"/&gt;<br />                                &lt;parameter name="targetEnvironment" value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/qa"/&gt;<br />                            &lt;/execution&gt;   <br />                        &lt;/data&gt;  <br />                    &lt;/datamodel&gt;<br />                    &lt;transition event="Promote" target="Testing"/&gt;                  <br />                &lt;/state&gt;<br />                &lt;state id="Testing"&gt;<br />                    &lt;datamodel&gt;<br />                        &lt;data name="checkItems"&gt;<br />                            &lt;item name="Effective Inspection Completed" forEvent=""&gt;<br />                            &lt;/item&gt;<br />                            &lt;item name="Test Cases Passed" forEvent=""&gt;<br />                            &lt;/item&gt;<br />                            &lt;item name="Smoke Test Passed" forEvent=""&gt;<br />                            &lt;/item&gt;<br />                        &lt;/data&gt;<br />                         &lt;data name="transitionExecution"&gt;<br />                            &lt;execution forEvent="Promote" class="org.wso2.carbon.executor.SvnDeploymentExecutor"&gt;<br />                                &lt;parameter name="currentEnvironment" value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/qa"/&gt;<br />                                &lt;parameter name="targetEnvironment" value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/prod"/&gt;<br />                            &lt;/execution&gt;<br /><br />                            &lt;execution forEvent="Demote" class="org.wso2.carbon.executor.SvnDeploymentExecutor"&gt;<br />                             &lt;parameter name="currentEnvironment" value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/qa"/&gt;<br />                            &lt;/execution&gt;<br />                        &lt;/data&gt;<br />                           <br />   <br />                    &lt;/datamodel&gt;<br />                    &lt;transition event="Promote" target="Production"/&gt;<br />                    &lt;transition event="Demote" target="Development"/&gt;<br />                &lt;/state&gt;<br />                &lt;state id="Production"&gt;  <br />                    &lt;datamodel&gt;<br />                        &lt;data name="checkItems"&gt;<br />                            &lt;item name="Verify No one using the application" forEvent=""&gt;<br />                            &lt;/item&gt;<br />                        &lt;/data&gt;<br />   &lt;data name="transitionExecution"&gt;<br />                            &lt;execution forEvent="Retire" class="org.wso2.carbon.executor.SvnDeploymentExecutor"&gt;<br />    &lt;parameter name="currentEnvironment" value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/qa"/&gt;<br />                                &lt;parameter name="targetEnvironment" value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/prod"/&gt;<br />                            &lt;/execution&gt;   <br />                        &lt;/data&gt;  <br />                    &lt;/datamodel&gt;<br />                    &lt;transition event="Retire" target="Retired"/&gt;<br />                &lt;/state&gt;  <br />                <br />                &lt;state id="Retired"&gt;  <br />                    &lt;datamodel&gt;     <br />                    &lt;/datamodel&gt;<br />                &lt;/state&gt;<br />                              <br />            &lt;/scxml&gt;<br />        &lt;/lifecycle&gt;<br />    &lt;/configuration&gt;<br />&lt;/aspect&gt;&nbsp;</code></pre></div></div></div><span id="internal-source-marker_0.09183679078705609"></span><br /><div><span style="font-family: Courier New; font-size: x-small; font-weight: normal;"><span style="white-space: pre-wrap;"><br /></span></span><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">In the above lifecycle configuration you need to change your svn locations that are used in promotions.</span><br /><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b><br /><span style="font-family: Arial; font-size: 15px; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">Eg: </span><br /><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b><br /><span style="font-family: Arial; font-size: 15px; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">From Dev to QA</span></div><div><pre><code>&lt;parameter name="currentEnvironment" value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/dev"/&gt;</code></pre></div><div>&nbsp; &lt;parameter name="targetEnvironment"&nbsp;</div><div>value="https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/qa"/&gt; </div><div style="font-weight: bold;"><b style="font-weight: normal;"><span style="font-family: 'Courier New'; font-size: 13px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div style="font-weight: bold;"><b id="internal-source-marker_0.8600791208446026" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">5) Attach the </span><span style="font-family: Arial; font-size: 15px; font-weight: bold; vertical-align: baseline; white-space: pre-wrap;">AppLifeCycle </span><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">to your application.</span></b></div><div style="font-weight: bold;"><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div style="font-weight: bold;"><b id="internal-source-marker_0.8600791208446026" style="font-weight: normal;"><img height="231px;" src="https://lh5.googleusercontent.com/33e3Gr2VOulxhePN0HcZuMN52RZQvruY_pQ6jOJoLXw_CEprMwdzafAmyCE0kFodHS255zXm2xa1r1N_1IQQDOlC6gA-rjhzR8gSk306rCo8gyKkStU" width="399px;" /></b></div><div style="font-weight: bold;"><b style="font-weight: normal;"><br /></b></div><div style="font-weight: bold;"><b id="internal-source-marker_0.8600791208446026" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">6) Promote Application from Development to Testing.</span><br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">This will copy external CApp from Dev environment to QA environment (in the relevant SVN locations)</span></b></div><div style="font-weight: bold;"><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div style="font-weight: bold;"><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div style="font-weight: bold;"><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div class="separator" style="clear: both; font-weight: bold; text-align: center;"><a href="http://2.bp.blogspot.com/-mdOX8mZscI4/UQ8Nm318gNI/AAAAAAAAA9c/kx4O0iRs3oU/s1600/promote-lc.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="219" src="http://2.bp.blogspot.com/-mdOX8mZscI4/UQ8Nm318gNI/AAAAAAAAA9c/kx4O0iRs3oU/s640/promote-lc.png" width="640" /></a></div><div style="font-weight: bold;"><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b> <br /><div><b><span style="font-family: Arial, Helvetica, sans-serif;"><br /></span></b></div><div><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">7) Demote Application from Testing to Development back</span><br /><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">This will remove the artifact from QA environment (QA SVN location)</span></b></div><div><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-F843hZvy0zg/UQ8TlfuTBiI/AAAAAAAAA9s/-SgIRZY2BhE/s1600/demote-lc.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="208" src="http://1.bp.blogspot.com/-F843hZvy0zg/UQ8TlfuTBiI/AAAAAAAAA9s/-SgIRZY2BhE/s640/demote-lc.png" width="640" /></a></div><div><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"><br /></span></b></div><div><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"></b><br /><h1 dir="ltr"><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"><span style="font-family: Arial; font-size: 24px; vertical-align: baseline; white-space: pre-wrap;">Deployment Automation with Jenkins</span></b></h1><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"></b><br /><h1 dir="ltr"><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"><div class="separator" style="clear: both; display: inline !important; text-align: center;"><b id="internal-source-marker_0.35913173598237336" style="font-weight: normal; text-align: -webkit-auto;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">1) Start Jenkins and add the URL to svn-executor-1.0.jar’s properties file.</span></b></div></b></b></h1><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"></b><br /><h1 dir="ltr"><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"><div class="separator" style="clear: both; display: inline !important; text-align: center;"><b id="internal-source-marker_0.35913173598237336" style="font-weight: normal; text-align: -webkit-auto;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">2) Create two Build jobs with name “promote” and “demote”.</span></b></div></b></b></h1><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"></b><br /><h1 dir="ltr"><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"><b id="internal-source-marker_0.4754765050020069" style="font-weight: normal;"><div class="separator" style="clear: both; display: inline !important; text-align: center;"><b id="internal-source-marker_0.35913173598237336" style="font-weight: normal; text-align: -webkit-auto;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;">3) Apply “This build is parameterized” check box and add following parameters to each of the job separately .</span></b></div></b></b></h1><span id="internal-source-marker_0.4754765050020069"></span><br /><ul style="font-weight: bold; margin-bottom: 0pt; margin-top: 0pt;"><span id="internal-source-marker_0.4754765050020069"><li dir="ltr" style="font-family: Arial; font-size: 15px; list-style-type: circle; vertical-align: baseline;"><b id="internal-source-marker_0.35913173598237336" style="font-weight: normal; text-align: -webkit-auto;"><span style="vertical-align: baseline; white-space: pre-wrap;">name</span></b></li><li dir="ltr" style="font-family: Arial; font-size: 15px; list-style-type: circle; vertical-align: baseline;"><b id="internal-source-marker_0.35913173598237336" style="font-weight: normal; text-align: -webkit-auto;"><span style="vertical-align: baseline; white-space: pre-wrap;">svnUrl</span></b></li><li dir="ltr" style="font-family: Arial; font-size: 15px; list-style-type: circle; vertical-align: baseline;"><b id="internal-source-marker_0.35913173598237336" style="font-weight: normal; text-align: -webkit-auto;"><span style="vertical-align: baseline; white-space: pre-wrap;">state</span></b></li></span></ul><span id="internal-source-marker_0.4754765050020069"><span id="internal-source-marker_0.35913173598237336" style="text-align: -webkit-auto;"><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b><br />4) Create a local repository (A folder in you local file system) to check out the artifacts.<br />eg: /home/user1/repository<br /><br />5) for promote Build job add the following script ( Build → Add build step → execute shell). Please change the values appropriately to suit your environment</span></span><br /><pre><code>#!/bin/bash<br /><br />if  [[ "${state}" == "Testing" ]] ;<br />then<br />##  repository location<br />cd /media/data/wso2/support/repository/<br /><br />svn checkout $svnUrl<br /><br /><br />## svn checkout location (This will be repository url + ‘qa’ as<br />## QA artifact was store in our repository<br />## https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/qa/<br /><br /><br />cd /media/data/wso2/support/repository/qa<br />cp -r ./$name <br /><br />## Location of the Testing server<br />/media/data/wso2/support/wso2qaesb-4.5.0/repository/carbonapps/0/<br />fi<br /><br />if [[ "${state}" == "Production" ]] ;<br />then<br />cd /media/data/wso2/support/repository/<br />svn checkout $svnUrl<br /><br />## svn checkout location (This will be repository url + ‘prod’ as<br />## Production artifact was store in our repository<br />## https://svn.wso2.org/repos/wso2/scratch/greg-scm-test/prod/<br /><br />cd /media/data/wso2/support/repository/prod<br />cp -r ./$name <br /><br />## url of the Production server<br />/media/data/wso2/support/wso2prodesb-4.5.0/repository/carbonapps/0/<br />fi&nbsp;<br /></code></pre></div><div><span style="text-align: -webkit-auto;"><span style="font-family: Courier New; font-weight: normal;"><span style="font-size: 15px; white-space: pre-wrap;"><br /></span></span><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b></span>6) For demote Build job use the following action ( Build → Add build step → execute shell)<span style="text-align: -webkit-auto;"><br /><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b></span> <br /><pre><code>#!/bin/bash<br /><br />if  [[ "${state}" == "Testing" ]] ;<br />then<br /><br />## location of the local ‘QA’ artifacts are stored.<br />cd /media/data/wso2/support/repository/qa<br /><br />svn update <br /><br />cd /media/data/wso2/support/wso2qaesb-4.5.0/repository/carbonapps/0<br /><br />rm -rf ./$name<br />fi<br /></code></pre></div><span style="text-align: -webkit-auto;"><br /><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b></span>7) When you promote as in the script it will deploy the artifact to Development server and when demote it will remove the Application from Carbon server which will respectively deploy/ undeploy<br /><br />8) You need to have similar script for artifact deployment from initial project to developer location which is not covered in the sample.<br /><br /><b style="font-weight: normal;"><span style="font-family: Arial; font-size: 15px; vertical-align: baseline; white-space: pre-wrap;"></span></b> </div>
